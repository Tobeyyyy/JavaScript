<!DOCTYPE html>
<html>
	<head>
		<title>UPC Converter</title>
		<link rel="stylesheet" type="text/css" href="style.css">
	</head>	
	<body>
	<div class="data_in_database">
		<h4>last start UPC:<p id="last_start"></p></h4>
		<h4>last end UPC:<p id="last_end"></p></h4>
	</div>
	<div class="content">
		<div>
		<input type="number" placeholder="enter start UPC" id="startupc" onchange="focusOnQty()"/><br>
		</div>
			<div>
		<input type="number" placeholder="How many UPC you want" id="upcqty" onchange="focusOnSubmit()"/><br>
		</div>
		<input id="clickMe" type="button" onclick="uploadDB(timeStamp);" value="Submit">
			<div>
		<p>Result:</p>
		<text class="result_box" id="result_box">Result shows here...</text>
		</div>
		</div>
	</body>
    <script src="js/script.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
     <script src="https://www.gstatic.com/firebasejs/4.1.1/firebase.js"></script>
	<script>
		<!-----------jquery-------------->
		//from IP Geolocation API
		document.getElementById("startupc").focus(); 
		function focusOnQty(){
		if($('#startupc').val().length==11){
			document.getElementById("upcqty").focus(); 
		}else{
			alert('You have '+$('#startupc').val().length+' digits UPC. \nPlease enter 11 digits UPC');
			document.getElementById("startupc").focus(); 
		}
		
		}
		function focusOnSubmit(){
			document.getElementById("clickMe").focus(); 
		}
		function getTime(){
			var today = new Date();
			var m = today.getMonth()+1;
			var d=today.getDate();
			var h=today.getHours();
			var t=today.getMinutes();
			var current= m+'/'+d+' '+h+':'+t;
			return current;
		}
		function getInputData(){
			var startupc=$('#startupc').val();
			var upcqty=$('#upcqty').val();
			console.log(startupc);
		}

		var timeStamp=getTime();
		
		var recordArray={};
		function uploadDB(timeStamp){
		console.log(timeStamp);

			var startupc=$('#startupc').val();
			var upcqty=$('#upcqty').val();
			if(startupc!=='' && upcqty!=''){
				var upc_string=ConvertMultiple(startupc,upcqty);
				$('#result_box').html(upc_string);
				upc_string=upc_string.split(',');
				recordArray['timeStamp']=timeStamp;
				recordArray['startupc']=upc_string[0].substring(0,11);
				var last_upc=upc_string.length-2;
				recordArray['endupc']=upc_string[last_upc].substring(0,11);
				recordArray['upcqty']=upcqty;
				recordArray['upc_string('+upc_string.length+')']=upc_string;
				console.log(recordArray);
				connectDB(recordArray);	
			}else{
				alert('Please enter data!');
				document.getElementById("startupc").focus(); 
			}
			
		}
	
  //Firebase
        function connectDB(thisip){
            //initialize firebase
            var config={
                apiKey:"AIzaSyA7l48kyYuE6YJzofESse0Wlhcw4WdhUUo",
                authDomain:"tobeyyyy-github.firebaseio.com",
                databaseURL:"https://tobeyyyy-github.firebaseio.com",
                projectId:"tobeyyyy-github",
                storageBucket:"tobeyyyy-github.appspot.com",
                messagingSenderId:"600571938704"
            }
            firebase.initializeApp(config);
            var helloMessageReference=firebase.database().ref("appAccount");
            var newarrayRef=helloMessageReference.push();
            newarrayRef.set(thisip);
        }
	

	
	</script>
	<style>
	.result_box {
  width: 300px;
  height: 100px;  
  padding: 50px;
  border: 1px solid red;
}
.content{
    width: 100%;
    height: 600px;
    text-align: center;
    font-size: 25px;
    margin-top: 30px;
}
input#startupc {
    padding: 10px;
}

input#upcqty {
    margin-top:20px;
        padding: 10px;
}
	</style>
</html>
